function Story(t){if("string"!=typeof t&&!(t instanceof String))throw new Error("Please provide a string to create a story object.");this.sections=t.split(/\r?\n/),this.title=this.sections.shift()}var rabbiEisikOfCrakow=rabbiEisikOfCrakow||{};rabbiEisikOfCrakow.story='The Story of Rabbi Eisik of Crakow\nAfter many years of great poverty which had never shaken his faith in G-d, he dreamed someone bade him look for a treasure in Prague, under the bridge which leads to the King�s palace.\nWhen the dream recurred a third time, Rabbi Eisik prepared for the journey and set out for Prague. But the bridge was guarded day and night and he did not dare to start digging. Nevertheless, he went to the bridge every morning and kept walking around it until evening.\nFinally, the captain of the guards, who had been watching him, asked in a kindly way whether he was looking for something or waiting for somebody. Rabbi Eisik told him of the dream which had brought him here from a faraway country.\nThe captain laughed: �And so to please the dream, you poor fellow wore out your shoes to come here! As for having faith in dreams, if I had it, I should have had to get going when a dream once told me to go to Cracow and dig for treasure under the stove in the room of a Jew � Eisik, son of Yekel, that was the name! Eisik, son of Yekel! I can just imagine what it would be like, how I should have to try every house over there, where one half of the Jews are named Eisik, and the other, Yekel!� And he laughed again.\nRabbi Eisik bowed, traveled home, dug up the treasure from under the stove, and built the house of prayer which is called "Reb Eisik�s Shul".',function(t){t.fn.expandAndFadeOut=function(e){var n=t.extend({},t.fn.expandAndFadeOut.defaults,e),i=new TimelineLite;return this.each(function(t){i.to(this,n.duration,{delay:n.delay,opacity:0,marginLeft:t*n.effectMagnitude,ease:n.ease,repeat:0},"expand")}),this}}(jQuery),$.fn.expandAndFadeOut.defaults={delay:0,duration:2,effectMagnitude:.3,ease:Expo.easeOut},function(t){t.fn.flyIn=function(e){var n=t.extend({},t.fn.flyIn.defaults,e);return this.each(function(t){TweenMax.from(this,n.duration,{opacity:0,x:util.random(-500,500),y:util.random(-500,500),z:util.random(-500,500),scale:.1,delay:t*n.effectMagnitude,yoyo:n.yoyoFlag,repeat:n.repeat,repeatDelay:n.repeatDelay})}),this}}(jQuery),$.fn.flyIn.defaults={duration:7,effectMagnitude:.02,yoyoFlag:!1,repeat:0,repeatDelay:0},function(t){function e(t,e,n,i){var a=i.offsetDelay+n*(i.totalDuration+i.durationBetween);t.to(e,i.durationIn,{opacity:1,x:0,ease:i.easeEffectIn,delay:a}).to(e,i.durationOut,{opacity:0,x:-150,ease:i.easeEffectOut,delay:i.durationStay})}t.fn.slideEach=function(n,i){var a=t.extend({},t.fn.slideEach.defaults,i);return a.totalDuration=a.durationIn+a.durationStay+a.durationOut,this.each(function(t){e(n,this,t,a)}),this}}(jQuery),$.fn.slideEach.defaults={offsetDelay:0,durationIn:1,durationStay:2,durationOut:.5,durationBetween:0,easeEffectIn:Power0.easeNone,easeEffectOut:Power4.easeIn};var util=util||{};util.random=function(t,e){return Math.random()*(e-t)+t},util.convertHtmlToLetters=function(t,e){var n=t.text();t.text("");var i=n.split("");return i=$.map(i,function(t){return" "==t?"&nbsp":t}),util.populateContainer(t,i,e)},util.convertHtmlToWords=function(t,e){var n=t.text();t.text("");var i=n.split(" ");return util.populateContainer(t,i,e)},util.populateContainer=function(t,e,n){return $.each(e,function(e,i){var a=$("<div/>").html(i).addClass(n);t.append(a)}),t.children()},util.fixHeight=function(t){var e=t.children().map(function(){return $(this).height()});t.height(Math.max.apply(Math,e))};var TimelineControls=function(){function t(){l.play(),i(c.playing)}function e(){l.pause(),i(c.paused)}function n(){l.restart(),i(c.playing)}function i(i){switch(i){case c.playing:h.text("pause"),h.one("click",e);break;case c.paused:h.text("play"),h.one("click",t);break;case c.completed:f.show(),h.text("restart"),h.one("click",n);break;default:throw new TypeError("An invalid state was supplied")}}function a(){$("#slider").slider("value",100*l.progress())}function o(){$("#slider").slider({range:!1,min:0,max:100,step:.1,slide:function(t,n){e(),l.progress(n.value/100)}})}function r(){l.eventCallback("onUpdate",a),l.eventCallback("onComplete",i,[c.completed]),d.mouseenter(function(){f.show()}).mouseleave(function(){f.hide()})}function u(){i(c.playing)}function s(t){l=t,o(),r()}var l,d=$("#controlsWrapper"),f=d.find("#controls"),h=f.find("#play"),c=(f.find("#restart"),{playing:"playing",paused:"paused",completed:"completed"});return{init:s,onStartAnimation:u}}(),StoryViewModel=function(){function t(t){var e={title:story.getTitle(),sections:story.getSections()};s.html(Mustache.render(l,e)),"function"==typeof t&&t(),o=s.find(".content"),util.fixHeight(o)}function e(e,n){u=e,t(n)}function n(){return void 0===r&&(r=s.find(".title")),r}function i(){n().hide()}function a(){return s.find("p")}var o,r,u,s=$("#story"),l=s.find("#story-template").html();return{init:e,getTitle:n,hideTitle:i,getSections:a}}();Story.prototype.getTitle=function(){return this.title},Story.prototype.getSections=function(){return this.sections};var StoryAnimation=function(){function t(){var t=util.convertHtmlToLetters(u.getTitle(),l);return t.flyIn({flyInDuration:_titleAnimConfig.flyInDuration}),t.expandAndFadeOut({delay:_titleAnimConfig.flyInDuration+_titleAnimConfig.stayDuration,duration:_titleAnimConfig.fadeOutDuration}),that}function e(t){return setTimeout(u.hideTitle,t),that}function n(t){return setTimeout(i,t),that}function i(){return s.onStartAnimation(),u.getSections().slideEach(d,{offsetDelay:0}),that}function a(){var t=_titleAnimConfig.flyInDuration+_titleAnimConfig.stayDuration+_titleAnimConfig.fadeOutDuration;return 1e3*t}function o(){var e=a();t().animateContentWithDelay(e)}function r(t){u=t,s.init(d,this)}var u,s=TimelineControls,l="letter",d=new TimelineLite;return _titleAnimConfig={flyInDuration:7,stayDuration:2,fadeOutDuration:2},_contentAnimConfig={delay:_titleAnimConfig,animationInDuration:.7,animationOutDuration:.5,animationStayDuration:3,delayBetweenAnimations:.4},that={init:r,start:o,hideTitleWithDelay:e,animateContentWithDelay:n}}(),story=new Story(rabbiEisikOfCrakow.story);StoryAnimation.init(StoryViewModel),StoryViewModel.init(story,StoryAnimation.start);